!function(t){function e(){function t(t){function e(t){for(var e,n=[],a=-1,i=t.length;++a<i;)e=t[a],n.push("M",r(e.key),",",p,"V",o(e.value),"h9V",p);return n.join("")}function a(t){var e=+("e"==t),r=e?1:-1,n=p/3;return"M"+.5*r+","+n+"A6,6 0 0 "+e+" "+6.5*r+","+(n+6)+"V"+(2*n-6)+"A6,6 0 0 "+e+" "+.5*r+","+2*n+"ZM"+2.5*r+","+(n+8)+"V"+(2*n-8)+"M"+4.5*r+","+(n+8)+"V"+(2*n-8)}var l=r.range()[1],p=o.range()[0];o.domain([0,i.top(1)[0].value]),t.each(function(){var t=d3.select(this),o=t.select("g");if(o.empty()){o=t.append("svg").attr("width",l+c.left+c.right).attr("height",p+c.top+c.bottom).append("g").attr("transform","translate("+c.left+","+c.top+")"),o.append("clipPath").attr("id","clip-"+s).append("rect").attr("width",l).attr("height",p),o.selectAll(".bar").data(["background","foreground"]).enter().append("path").attr("class",function(t){return t+" bar"}).datum(i.all()),o.selectAll(".foreground.bar").attr("clip-path","url(#clip-"+s+")"),o.append("g").attr("class","axis").attr("transform","translate(0,"+p+")").call(u);var f=o.append("g").attr("class","brush").call(d);f.selectAll("rect").attr("height",p),f.selectAll(".resize").append("path").attr("d",a)}if(n)if(n=!1,o.selectAll(".brush").call(d),d.empty())o.selectAll("#clip-"+s+" rect").attr("x",0).attr("width",l);else{var h=d.extent();o.selectAll("#clip-"+s+" rect").attr("x",r(h[0])).attr("width",r(h[1])-r(h[0]))}o.selectAll(".bar").attr("d",e)})}e.id||(e.id=0);var r,n,a,i,l,c={top:10,right:10,bottom:20,left:10},o=d3.scale.linear().range([100,0]),s=e.id++,u=d3.svg.axis().orient("bottom"),d=d3.svg.brush();return d.on("brush.chart",function(){var t=d3.select(this.parentNode),e=d.extent();l&&t.select(".brush").call(d.extent(e=e.map(l))).selectAll(".resize").style("display",null),t.select("#clip-"+s+" rect").attr("x",r(e[0])).attr("width",r(e[1])-r(e[0])),a.filterRange(e)}),d.on("brushend.chart",function(){if(d.empty()){var t=d3.select(this.parentNode.parentNode.parentNode);t.select("#clip-"+s+" rect").attr("x",null).attr("width","100%"),a.filterAll()}}),t.margin=function(e){return arguments.length?(c=e,t):c},t.x=function(e){return arguments.length?(r=e,u.scale(r),d.x(r),t):r},t.y=function(e){return arguments.length?(o=e,t):o},t.dimension=function(e){return arguments.length?(a=e,t):a},t.filter=function(e){return e?(d.extent(e),a.filterRange(e)):(d.clear(),a.filterAll()),n=!0,t},t.group=function(e){return arguments.length?(i=e,t):i},t.round=function(e){return arguments.length?(l=e,t):l},d3.rebind(t,d,"on")}function r(t){function r(t){var e=p[t];if(g[0].hasOwnProperty(t))return t;for(var r=0;u>r;++r){var n=h[r].dimension(function(e){return e[t]}),i=n.group(function(t){var r=e.bucketSize;return Math.floor(t/r)*r});g[r][t]=n,v[r][t]=i}return m[t]={name:e.name,min:e.min,max:e.max},d3.selectAll("#metric-selector-"+t).style("display","none"),a(t),t}function a(t){if(!b.hasOwnProperty(t)){for(var r=m[t],n=[],a=0;u>a;++a)n.push(e().dimension(g[a][t]).group(v[a][t]).x(d3.scale.linear().domain([r.min,r.max]).rangeRound([0,10*d])));b[t]=A.length,A.push({id:t,name:r.name,charts:n}),l(A)}}function i(t){A.splice(b[t],1),delete b[t];for(var e=0;u>e;++e)v[e][t].dispose(),delete v[e][t],g[e][t].dispose(),delete g[e][t];d3.selectAll("#metric-selector-"+t).style("display",null),l(A)}function l(t){var e=d3.selectAll("#charts").selectAll("div.chart-container").data(t,function(t){return t.id}),r=e.enter().append("div").attr("class","chart-container"),n=r.append("div").attr("class","chart-title");n.append("span").text(function(t){return t.name}),n.append("a").text("Remove").attr("href","#").on("click",function(t){return i(t.id),!1}),e.exit().remove(),e.order()}var c={},o=d3.format(",d"),s={a:"duration",b:"usermode",c:"system calls",d:"interrupted",e:"wait-cpu",f:"wait-blocked",g:"timer",h:"network",i:"block-device",j:"user-input"},u=2,d=50,p={},f=[],h=[],m={},g=[],v=[],x=[],b={},A=[];return d3.json(t,function(t,e){e.executions.forEach(function(t){t.b=t.a*(.5+Math.random())}),e.executions.forEach(function(t){n(t,function(e){if("samples"!=e)if(p.hasOwnProperty(e)){var r=p[e];r.min=Math.min(r.min,t[e]),r.max=Math.max(r.max,t[e])}else{var r={id:e,name:s[e],min:t[e],max:t[e]};p[e]=r,f.push(r)}})}),f.forEach(function(t){t.bucketSize=(t.max-t.min)/d});for(var a=0;u>a;++a)h.push(crossfilter(e.executions)),g.push({}),v.push({}),x.push(h[a].groupAll());var i=d3.selectAll("#metric-selector").selectAll("li").data(f,function(t){return t.id}),l=i.enter().append("li");l.text(function(t){return t.name}),l.attr("id",function(t){return"metric-selector-"+t.id}),l.on("click",function(t){r(t.id)}),i.exit().remove(),d3.selectAll("#total").text(o(e.executions.length))}),c}function n(t,e){for(var r in t)t.hasOwnProperty(r)&&e(r)}r.version="1.0.0",t.tracecompare=r}("undefined"!=typeof exports&&exports||this);